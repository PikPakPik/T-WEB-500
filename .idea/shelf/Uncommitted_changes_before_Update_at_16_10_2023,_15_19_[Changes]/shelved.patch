Index: client/src/pages/Ad/AdDetail.jsx
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import { Icon } from \"@iconify/react/dist/iconify.js\";\nimport moment from \"moment\";\nimport { useParams } from \"react-router-dom\";\nimport { useState, useEffect } from \"react\";\nimport { useAuth } from \"../../hooks/useAuth\";\n\n// Fonction pour récupérer les détails de l'annonce et de l'entreprise\nconst fetchAdAndCompany = async (avertissementId) => {\n  const res1 = await fetch(`http://localhost:3001/advert/${avertissementId}`);\n  const ad = await res1.json();\n  const res2 = await fetch(`http://localhost:3001/company/${ad.companyId}`);\n  const company = await res2.json();\n  return { ...ad, company };\n};\n\nconst AdDetail = () => {\n  const [ad, setAd] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const { avertissementId } = useParams();\n  const { user } = useAuth();\n\n  const [formData, setFormData] = useState({});\n\n  useEffect(() => {\n    // Fonction asynchrone pour récupérer les données\n    (async () => {\n      try {\n        const fetchedAd = await fetchAdAndCompany(avertissementId);\n        setAd(fetchedAd);\n        setLoading(false);\n      } catch (error) {\n        console.error(\"Error fetching ad and company data:\", error);\n      }\n    })();\n\n    if (user && !loading) {\n      setFormData({\n        firstName: user.firstName || \"\",\n        lastName: user.lastName || \"\",\n        email: user.email || \"\",\n        exp: user.exp || \"\",\n        school: user.school || \"\",\n        skills: user.skills || \"\",\n      });\n    }\n  }, [avertissementId, user, loading]);\n\n  // Affichage de l'état de chargement\n  if (loading) {\n    return <div>loading...</div>;\n  }\n\n  // Destructuration des données de l'annonce\n  const {\n    title,\n    company: { logo, name },\n    place,\n    expRequired,\n    workingTime,\n    date,\n    wages,\n    description,\n  } = ad;\n\n  return (\n    <div className=\"container mx-auto px-4 mt-5\">\n      <div className=\"flex flex-col\">\n        <div className=\"flex flex-row justify-between\">\n          <div className=\"flex flex-col\">\n            <h1 className=\"text-3xl font-bold\">{title}</h1>\n            <div className=\"flex flex-row gap-3 mt-3\">\n              <img\n                src={logo}\n                alt=\"logo\"\n                className=\"w-28 h-28 inline-block mr-2\"\n              />\n              <div className=\"flex flex-col\">\n                <p className=\"text-xl font-semibold\">{name}</p>\n                <div className=\"flex md:flex-row flex-col gap-3 mt-3\">\n                  <div className=\"badge badge-outline md:whitespace-nowrap md:text-xs\">\n                    <Icon\n                      icon=\"fluent:location-24-regular\"\n                      className=\"w-4 mr-1\"\n                    />\n                    {place}\n                  </div>\n                  <div className=\"badge badge-outline md:whitespace-nowrap md:text-xs\">\n                    <Icon\n                      icon=\"material-symbols:school-outline\"\n                      className=\"w-4 mr-1\"\n                    />\n                    {expRequired}\n                  </div>\n                  <div className=\"badge badge-outline md:whitespace-nowrap md:text-xs\">\n                    <Icon icon=\"ri:time-line\" className=\"w-4 mr-1\" />\n                    {workingTime}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex flex-col\">\n            <div className=\"flex flex-row gap-3 self-end\">\n              <button className=\"btn btn-outline btn-circle btn-sm\">\n                <Icon icon=\"fluent:share-24-regular\" />\n              </button>\n              <button className=\"btn btn-outline btn-circle btn-sm hover:text-red-600\">\n                <Icon icon=\"mdi:heart\" />\n              </button>\n            </div>\n            <div className=\"flex flex-col gap-3 mt-3\">\n              <div className=\"flex flex-row gap-1 items-center text-xs\">\n                <Icon icon=\"ci:clock\" />\n                Posté il y a{\" \"}\n                {moment.utc(date).local().startOf(\"seconds\").fromNow()}\n              </div>\n              <span className=\"font-bold uppercase self-end\">{wages}€/an</span>\n              {/* Bouton pour postuler */}\n              <button\n                className=\"btn btn-info\"\n                onClick={() =>\n                  document.getElementById(\"my_modal_5\").showModal()\n                }\n              >\n                Je postule\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n      {/* Description de l'annonce */}\n      <div className=\"flex flex-col mt-16\">\n        <h2 className=\"text-2xl font-bold\">Description</h2>\n        <p className=\"mt-3 text-base text-gray-500\">{description}</p>\n      </div>\n\n      {/* Modal */}\n      <dialog id=\"my_modal_5\" className=\"modal modal-bottom sm:modal-middle\">\n        <div className=\"modal-box\">\n          <div className=\"font-bold text-lg\">\n            Je postule chez <span className=\"underline\">{name}</span>\n          </div>\n          <hr className=\"my-6\" />\n          <form className=\"space-y-2\">\n            <label htmlFor=\"firstName\" className=\"label\">\n              Prénom\n            </label>\n            <input\n              name=\"firstName\"\n              type=\"text\"\n              placeholder=\"John\"\n              className=\"input input-bordered w-full\"\n              value={formData.firstName}\n            />\n            <label htmlFor=\"lastName\" className=\"label\">\n              Nom\n            </label>\n            <input\n              name=\"lastName\"\n              type=\"text\"\n              placeholder=\"Doe\"\n              className=\"input input-bordered w-full\"\n              value={formData.lastName}\n            />\n            <label htmlFor=\"email\" className=\"label\">\n              Email\n            </label>\n            <input\n              name=\"email\"\n              type=\"email\"\n              placeholder=\"johndoe@exemple.com\"\n              className=\"input input-bordered w-full\"\n              value={formData.email}\n            />\n            <label htmlFor=\"exp\" className=\"label\">\n              Expérience\n            </label>\n            <select\n              name=\"exp\"\n              className=\"select select-bordered w-full\"\n              required\n              value={formData.exp}\n            >\n              <option selected disabled>\n                --Choisir une option--\n              </option>\n              <option value=\"jeune\">Jeune diplômé</option>\n              <option value=\"junior\">Junior</option>\n              <option value=\"confirme\">Confirmé</option>\n              <option value=\"senior\">Senior</option>\n            </select>\n            <label htmlFor=\"school\" className=\"label\">\n              Ecole\n            </label>\n            <input\n              name=\"school\"\n              type=\"text\"\n              placeholder=\"Ecole 42\"\n              className=\"input input-bordered w-full\"\n              value={formData.school}\n            />\n            <label htmlFor=\"skills\" className=\"label\">\n              Compétences\n            </label>\n            <input\n              name=\"skills\"\n              type=\"text\"\n              placeholder=\"React, Node.js, ...\"\n              className=\"input input-bordered w-full\"\n              value={formData.skills}\n            />\n          </form>\n          <div className=\"modal-action border-t-2 mt-6 pt-4 flex justify-between gap-4\">\n            <button\n              className=\"btn btn-primary\"\n              onClick={() => document.getElementById(\"my_modal_5\").close()}\n            >\n              Envoyer\n            </button>\n            <form method=\"dialog\">\n              {/* Formulaire de candidature */}\n              <button className=\"btn\">Annuler</button>\n            </form>\n          </div>\n        </div>\n      </dialog>\n    </div>\n  );\n};\n\nexport default AdDetail;\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/client/src/pages/Ad/AdDetail.jsx b/client/src/pages/Ad/AdDetail.jsx
--- a/client/src/pages/Ad/AdDetail.jsx	(revision 10c392abb32c5c8cd9c318f0603d0a7968b67341)
+++ b/client/src/pages/Ad/AdDetail.jsx	(date 1697461738611)
@@ -26,6 +26,7 @@
     (async () => {
       try {
         const fetchedAd = await fetchAdAndCompany(avertissementId);
+        console.log(fetchedAd);
         setAd(fetchedAd);
         setLoading(false);
       } catch (error) {
@@ -104,7 +105,23 @@
               <button className="btn btn-outline btn-circle btn-sm">
                 <Icon icon="fluent:share-24-regular" />
               </button>
-              <button className="btn btn-outline btn-circle btn-sm hover:text-red-600">
+              <button
+                className="btn btn-outline btn-circle btn-sm hover:text-red-600"
+                onClick={() => {
+                  fetch(
+                    `http://localhost:3001/advert/${avertissementId}/like`,
+                    {
+                      method: "POST",
+                      headers: {
+                        "Content-Type": "application/json",
+                      },
+                      body: JSON.stringify({
+                        userId: user.id,
+                      }),
+                    },
+                  );
+                }}
+              >
                 <Icon icon="mdi:heart" />
               </button>
             </div>
